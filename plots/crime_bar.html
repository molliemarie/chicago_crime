<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>D3: A bar chart with divs</title>
		<script src="https://d3js.org/d3.v4.min.js"></script>
		<style type="text/css">
		
/*			div.bar {
				display: inline-block;
				width: 20px;
				height: 75px;	 Gets overriden by D3-assigned height below 
				margin-right: 2px;
				background-color: teal;
			}*/
		
		</style>
	</head>
	<body>
		<script type="text/javascript">

		var margin = {top: 20, right: 50, bottom: 70, left: 40};

		var w = 600 - margin.left - margin.right,
			h = 400 - margin.top - margin.bottom,
			barPadding = 1,
			padding = 30;

		var dataset;


		// var yScale = d3.scaleLinear()
		// 			   .range([h, 0]);

		// var xScale = d3.scaleBand()
		// 			   .padding([.1])

		d3.csv("crime_count_by_year_2016.csv", function(data) {
			dataset = data;
			console.log(dataset);

			var yScale = d3.scaleLinear()
						   .domain([0, d3.max(dataset, function(d) { return parseInt(d.count); })])
						   .range([h - margin.bottom, 0])

			
			// var xScale = d3.scaleOrdinal()
			//    .domain([d3.set(dataset.map(function(d) { return d.violation })).values()])
			//    .rangeRound([margin.left, w]);
			var xScale = d3.scaleLinear()
						   .domain([0, dataset.length])
						   .range([margin.left, w]);
						   // .padding(0;.5);

			var test_vals = d3.set(dataset.map(function(d) { return d.violation })).values()
			console.log(test_vals)

			var ordinal = [0, dataset.length]
			// console.log([0,w])
			// console.log(xScale(20))


			var max = d3.max(dataset, function(d) { return parseInt(d.count); })
			// console.log(max)

			var svg = d3.select("body")
			            .append("svg")
			            .attr("width", w)
			            .attr("height", h);

			var yAxis = d3.axisLeft()
						  .scale(yScale);
						  // .ticks(5);

			var xAxis = d3.axisBottom()
						  .scale(xScale);
						  // .ticks(5);

			svg.selectAll("rect")
			   .data(dataset)
			   .enter()
			   .append("rect")
			   .attr("x", function(d, i) {
			   	return xScale(i);
			   })
			   .attr("y", function(d){
			   	return yScale(d.count);
			   })
			   .attr("width", (w - margin.left) / dataset.length - barPadding)
			   .attr("height", function(d) {
			   	return h - yScale(d.count) - margin.bottom;
			   });

			svg.append("g")
			   .attr("class", "y axis")
			   .attr("transform", "translate(" + margin.left + ",0)")
			   .call(yAxis);

			svg.append("g")
			   .attr("class", "x axis")
			   .attr("transform","translate(0," + (h - margin.bottom) + ")")
			   .call(xAxis)
			   // .selectAll("text")
			   // .attr;

					});

			
		</script>
	</body>
</html>